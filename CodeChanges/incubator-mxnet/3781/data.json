{
  "url": "https://api.github.com/repos/apache/mxnet/pulls/3781",
  "id": 93023881,
  "node_id": "MDExOlB1bGxSZXF1ZXN0OTMwMjM4ODE=",
  "html_url": "https://github.com/apache/mxnet/pull/3781",
  "diff_url": "https://github.com/apache/mxnet/pull/3781.diff",
  "patch_url": "https://github.com/apache/mxnet/pull/3781.patch",
  "issue_url": "https://api.github.com/repos/apache/mxnet/issues/3781",
  "number": 3781,
  "state": "closed",
  "locked": false,
  "title": "Less redundant Reshape spec",
  "user": {
    "login": "taliesinb",
    "id": 365157,
    "node_id": "MDQ6VXNlcjM2NTE1Nw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/365157?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/taliesinb",
    "html_url": "https://github.com/taliesinb",
    "followers_url": "https://api.github.com/users/taliesinb/followers",
    "following_url": "https://api.github.com/users/taliesinb/following{/other_user}",
    "gists_url": "https://api.github.com/users/taliesinb/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/taliesinb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/taliesinb/subscriptions",
    "organizations_url": "https://api.github.com/users/taliesinb/orgs",
    "repos_url": "https://api.github.com/users/taliesinb/repos",
    "events_url": "https://api.github.com/users/taliesinb/events{/privacy}",
    "received_events_url": "https://api.github.com/users/taliesinb/received_events",
    "type": "User",
    "site_admin": false
  },
  "body": "The core ability this gives is to allow certain kinds of reshape without requiring you to know all the dimensions up-front, in a more flexible way than the current codes 0 and -1. This make it easier for humans to express certain kinds of ops, but also makes it possible for machines to express certain reshapes without having to know exact sizes of irrelevant parts of the input. \r\n\r\nThat's what I'm using this for our fork: helping our neural network framework unroll recurrent networks more easily and efficiently. You typically can prove ahead of time that an unrolling algorithm is correct, and for speed reasons you do NOT want to track tensor dimensions during unrolling at run-time. But Reshape layer demands to know all tensor sizes even when the desired resize operation doesn't actually depend on them.\r\n\r\nSo this PR adds 3 more codes to Reshape that let it figure out more things itself:\r\n* -2: copy all remaining dimensions from input shape to output shape\r\n* -3: merge two adjacent dimensions in input shape\r\n* -4: split a single dimension in input shape into two (where either one can be inferred if given the other).\r\n\r\nIt should be pretty straightforward to add more codes in future, like maybe a code for merging all remaining dimensions. \r\n\r\nThese are documented formally in the description of \"target_shape\" with proper indices etc, the previous documentation was very vague.\r\n\r\nHere's an example that illustrates all three: let's say you want to 'broadcast' an operation across a sequence by simply merging the sequence and batch dimensions together and then doing an ordinary batched op. That kind of merge op can be expressed as a Reshape with target `(-3, -2)` -- merge the first two dimensions, then copy the rest. After you apply the op you'll want to do an unmerge: which is `(-4,slen,-1,-2)`. Notice that the only static information we needed to know here was the sequence length to unmerge properly. The dimensions and rank of the inner tensors was not needed. \r\n\r\nAnother example: any existing code will be able to replace any sequence of \"0s\" with a single \"-2\".",
  "created_at": "2016-11-09T19:29:41Z",
  "updated_at": "2016-11-24T09:02:29Z",
  "closed_at": "2016-11-12T21:13:58Z",
  "merged_at": "2016-11-12T21:13:58Z",
  "merge_commit_sha": "52576527118eeee5a13a6ac3845ce6fa1dc1d01f",
  "assignee": null,
  "assignees": [],
  "requested_reviewers": [],
  "requested_teams": [],
  "labels": [],
  "milestone": null,
  "draft": false,
  "commits_url": "https://api.github.com/repos/apache/mxnet/pulls/3781/commits",
  "review_comments_url": "https://api.github.com/repos/apache/mxnet/pulls/3781/comments",
  "review_comment_url": "https://api.github.com/repos/apache/mxnet/pulls/comments{/number}",
  "comments_url": "https://api.github.com/repos/apache/mxnet/issues/3781/comments",
  "statuses_url": "https://api.github.com/repos/apache/mxnet/statuses/ff541255e6e2d98c0b91ac8bcf6a9cae54da17e9",
  "head": {
    "label": "taliesinb:feature/RichReshapeSpec",
    "ref": "feature/RichReshapeSpec",
    "sha": "ff541255e6e2d98c0b91ac8bcf6a9cae54da17e9",
    "user": {
      "login": "taliesinb",
      "id": 365157,
      "node_id": "MDQ6VXNlcjM2NTE1Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/365157?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/taliesinb",
      "html_url": "https://github.com/taliesinb",
      "followers_url": "https://api.github.com/users/taliesinb/followers",
      "following_url": "https://api.github.com/users/taliesinb/following{/other_user}",
      "gists_url": "https://api.github.com/users/taliesinb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/taliesinb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/taliesinb/subscriptions",
      "organizations_url": "https://api.github.com/users/taliesinb/orgs",
      "repos_url": "https://api.github.com/users/taliesinb/repos",
      "events_url": "https://api.github.com/users/taliesinb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/taliesinb/received_events",
      "type": "User",
      "site_admin": false
    },
    "repo": {
      "id": 73275570,
      "node_id": "MDEwOlJlcG9zaXRvcnk3MzI3NTU3MA==",
      "name": "mxnet",
      "full_name": "taliesinb/mxnet",
      "private": false,
      "owner": {
        "login": "taliesinb",
        "id": 365157,
        "node_id": "MDQ6VXNlcjM2NTE1Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/365157?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/taliesinb",
        "html_url": "https://github.com/taliesinb",
        "followers_url": "https://api.github.com/users/taliesinb/followers",
        "following_url": "https://api.github.com/users/taliesinb/following{/other_user}",
        "gists_url": "https://api.github.com/users/taliesinb/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/taliesinb/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/taliesinb/subscriptions",
        "organizations_url": "https://api.github.com/users/taliesinb/orgs",
        "repos_url": "https://api.github.com/users/taliesinb/repos",
        "events_url": "https://api.github.com/users/taliesinb/events{/privacy}",
        "received_events_url": "https://api.github.com/users/taliesinb/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/taliesinb/mxnet",
      "description": "Lightweight, Portable, Flexible Distributed/Mobile Deep Learning with Dynamic, Mutation-aware Dataflow Dep Scheduler; for Python, R, Julia, Scala, Go, Javascript and more",
      "fork": true,
      "url": "https://api.github.com/repos/taliesinb/mxnet",
      "forks_url": "https://api.github.com/repos/taliesinb/mxnet/forks",
      "keys_url": "https://api.github.com/repos/taliesinb/mxnet/keys{/key_id}",
      "collaborators_url": "https://api.github.com/repos/taliesinb/mxnet/collaborators{/collaborator}",
      "teams_url": "https://api.github.com/repos/taliesinb/mxnet/teams",
      "hooks_url": "https://api.github.com/repos/taliesinb/mxnet/hooks",
      "issue_events_url": "https://api.github.com/repos/taliesinb/mxnet/issues/events{/number}",
      "events_url": "https://api.github.com/repos/taliesinb/mxnet/events",
      "assignees_url": "https://api.github.com/repos/taliesinb/mxnet/assignees{/user}",
      "branches_url": "https://api.github.com/repos/taliesinb/mxnet/branches{/branch}",
      "tags_url": "https://api.github.com/repos/taliesinb/mxnet/tags",
      "blobs_url": "https://api.github.com/repos/taliesinb/mxnet/git/blobs{/sha}",
      "git_tags_url": "https://api.github.com/repos/taliesinb/mxnet/git/tags{/sha}",
      "git_refs_url": "https://api.github.com/repos/taliesinb/mxnet/git/refs{/sha}",
      "trees_url": "https://api.github.com/repos/taliesinb/mxnet/git/trees{/sha}",
      "statuses_url": "https://api.github.com/repos/taliesinb/mxnet/statuses/{sha}",
      "languages_url": "https://api.github.com/repos/taliesinb/mxnet/languages",
      "stargazers_url": "https://api.github.com/repos/taliesinb/mxnet/stargazers",
      "contributors_url": "https://api.github.com/repos/taliesinb/mxnet/contributors",
      "subscribers_url": "https://api.github.com/repos/taliesinb/mxnet/subscribers",
      "subscription_url": "https://api.github.com/repos/taliesinb/mxnet/subscription",
      "commits_url": "https://api.github.com/repos/taliesinb/mxnet/commits{/sha}",
      "git_commits_url": "https://api.github.com/repos/taliesinb/mxnet/git/commits{/sha}",
      "comments_url": "https://api.github.com/repos/taliesinb/mxnet/comments{/number}",
      "issue_comment_url": "https://api.github.com/repos/taliesinb/mxnet/issues/comments{/number}",
      "contents_url": "https://api.github.com/repos/taliesinb/mxnet/contents/{+path}",
      "compare_url": "https://api.github.com/repos/taliesinb/mxnet/compare/{base}...{head}",
      "merges_url": "https://api.github.com/repos/taliesinb/mxnet/merges",
      "archive_url": "https://api.github.com/repos/taliesinb/mxnet/{archive_format}{/ref}",
      "downloads_url": "https://api.github.com/repos/taliesinb/mxnet/downloads",
      "issues_url": "https://api.github.com/repos/taliesinb/mxnet/issues{/number}",
      "pulls_url": "https://api.github.com/repos/taliesinb/mxnet/pulls{/number}",
      "milestones_url": "https://api.github.com/repos/taliesinb/mxnet/milestones{/number}",
      "notifications_url": "https://api.github.com/repos/taliesinb/mxnet/notifications{?since,all,participating}",
      "labels_url": "https://api.github.com/repos/taliesinb/mxnet/labels{/name}",
      "releases_url": "https://api.github.com/repos/taliesinb/mxnet/releases{/id}",
      "deployments_url": "https://api.github.com/repos/taliesinb/mxnet/deployments",
      "created_at": "2016-11-09T10:50:26Z",
      "updated_at": "2018-11-16T10:07:05Z",
      "pushed_at": "2018-11-27T10:47:09Z",
      "git_url": "git://github.com/taliesinb/mxnet.git",
      "ssh_url": "git@github.com:taliesinb/mxnet.git",
      "clone_url": "https://github.com/taliesinb/mxnet.git",
      "svn_url": "https://github.com/taliesinb/mxnet",
      "homepage": "http://mxnet.io",
      "size": 48093,
      "stargazers_count": 0,
      "watchers_count": 0,
      "language": "C++",
      "has_issues": false,
      "has_projects": true,
      "has_downloads": true,
      "has_wiki": false,
      "has_pages": false,
      "has_discussions": false,
      "forks_count": 0,
      "mirror_url": null,
      "archived": false,
      "disabled": false,
      "open_issues_count": 0,
      "license": {
        "key": "apache-2.0",
        "name": "Apache License 2.0",
        "spdx_id": "Apache-2.0",
        "url": "https://api.github.com/licenses/apache-2.0",
        "node_id": "MDc6TGljZW5zZTI="
      },
      "allow_forking": true,
      "is_template": false,
      "web_commit_signoff_required": false,
      "topics": [],
      "visibility": "public",
      "forks": 0,
      "open_issues": 0,
      "watchers": 0,
      "default_branch": "master"
    }
  },
  "base": {
    "label": "apache:master",
    "ref": "master",
    "sha": "76ac4b82271dbabbd3be200cc15b98bc52ae8a1c",
    "user": {
      "login": "apache",
      "id": 47359,
      "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ3MzU5",
      "avatar_url": "https://avatars.githubusercontent.com/u/47359?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/apache",
      "html_url": "https://github.com/apache",
      "followers_url": "https://api.github.com/users/apache/followers",
      "following_url": "https://api.github.com/users/apache/following{/other_user}",
      "gists_url": "https://api.github.com/users/apache/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/apache/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/apache/subscriptions",
      "organizations_url": "https://api.github.com/users/apache/orgs",
      "repos_url": "https://api.github.com/users/apache/repos",
      "events_url": "https://api.github.com/users/apache/events{/privacy}",
      "received_events_url": "https://api.github.com/users/apache/received_events",
      "type": "Organization",
      "site_admin": false
    },
    "repo": {
      "id": 34864402,
      "node_id": "MDEwOlJlcG9zaXRvcnkzNDg2NDQwMg==",
      "name": "mxnet",
      "full_name": "apache/mxnet",
      "private": false,
      "owner": {
        "login": "apache",
        "id": 47359,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjQ3MzU5",
        "avatar_url": "https://avatars.githubusercontent.com/u/47359?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/apache",
        "html_url": "https://github.com/apache",
        "followers_url": "https://api.github.com/users/apache/followers",
        "following_url": "https://api.github.com/users/apache/following{/other_user}",
        "gists_url": "https://api.github.com/users/apache/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/apache/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/apache/subscriptions",
        "organizations_url": "https://api.github.com/users/apache/orgs",
        "repos_url": "https://api.github.com/users/apache/repos",
        "events_url": "https://api.github.com/users/apache/events{/privacy}",
        "received_events_url": "https://api.github.com/users/apache/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "html_url": "https://github.com/apache/mxnet",
      "description": "Lightweight, Portable, Flexible Distributed/Mobile Deep Learning with Dynamic, Mutation-aware Dataflow Dep Scheduler; for Python, R, Julia, Scala, Go, Javascript and more",
      "fork": false,
      "url": "https://api.github.com/repos/apache/mxnet",
      "forks_url": "https://api.github.com/repos/apache/mxnet/forks",
      "keys_url": "https://api.github.com/repos/apache/mxnet/keys{/key_id}",
      "collaborators_url": "https://api.github.com/repos/apache/mxnet/collaborators{/collaborator}",
      "teams_url": "https://api.github.com/repos/apache/mxnet/teams",
      "hooks_url": "https://api.github.com/repos/apache/mxnet/hooks",
      "issue_events_url": "https://api.github.com/repos/apache/mxnet/issues/events{/number}",
      "events_url": "https://api.github.com/repos/apache/mxnet/events",
      "assignees_url": "https://api.github.com/repos/apache/mxnet/assignees{/user}",
      "branches_url": "https://api.github.com/repos/apache/mxnet/branches{/branch}",
      "tags_url": "https://api.github.com/repos/apache/mxnet/tags",
      "blobs_url": "https://api.github.com/repos/apache/mxnet/git/blobs{/sha}",
      "git_tags_url": "https://api.github.com/repos/apache/mxnet/git/tags{/sha}",
      "git_refs_url": "https://api.github.com/repos/apache/mxnet/git/refs{/sha}",
      "trees_url": "https://api.github.com/repos/apache/mxnet/git/trees{/sha}",
      "statuses_url": "https://api.github.com/repos/apache/mxnet/statuses/{sha}",
      "languages_url": "https://api.github.com/repos/apache/mxnet/languages",
      "stargazers_url": "https://api.github.com/repos/apache/mxnet/stargazers",
      "contributors_url": "https://api.github.com/repos/apache/mxnet/contributors",
      "subscribers_url": "https://api.github.com/repos/apache/mxnet/subscribers",
      "subscription_url": "https://api.github.com/repos/apache/mxnet/subscription",
      "commits_url": "https://api.github.com/repos/apache/mxnet/commits{/sha}",
      "git_commits_url": "https://api.github.com/repos/apache/mxnet/git/commits{/sha}",
      "comments_url": "https://api.github.com/repos/apache/mxnet/comments{/number}",
      "issue_comment_url": "https://api.github.com/repos/apache/mxnet/issues/comments{/number}",
      "contents_url": "https://api.github.com/repos/apache/mxnet/contents/{+path}",
      "compare_url": "https://api.github.com/repos/apache/mxnet/compare/{base}...{head}",
      "merges_url": "https://api.github.com/repos/apache/mxnet/merges",
      "archive_url": "https://api.github.com/repos/apache/mxnet/{archive_format}{/ref}",
      "downloads_url": "https://api.github.com/repos/apache/mxnet/downloads",
      "issues_url": "https://api.github.com/repos/apache/mxnet/issues{/number}",
      "pulls_url": "https://api.github.com/repos/apache/mxnet/pulls{/number}",
      "milestones_url": "https://api.github.com/repos/apache/mxnet/milestones{/number}",
      "notifications_url": "https://api.github.com/repos/apache/mxnet/notifications{?since,all,participating}",
      "labels_url": "https://api.github.com/repos/apache/mxnet/labels{/name}",
      "releases_url": "https://api.github.com/repos/apache/mxnet/releases{/id}",
      "deployments_url": "https://api.github.com/repos/apache/mxnet/deployments",
      "created_at": "2015-04-30T16:21:15Z",
      "updated_at": "2022-12-26T23:36:03Z",
      "pushed_at": "2022-12-23T18:30:58Z",
      "git_url": "git://github.com/apache/mxnet.git",
      "ssh_url": "git@github.com:apache/mxnet.git",
      "clone_url": "https://github.com/apache/mxnet.git",
      "svn_url": "https://github.com/apache/mxnet",
      "homepage": "https://mxnet.apache.org",
      "size": 101055,
      "stargazers_count": 20203,
      "watchers_count": 20203,
      "language": "C++",
      "has_issues": true,
      "has_projects": true,
      "has_downloads": true,
      "has_wiki": true,
      "has_pages": false,
      "has_discussions": true,
      "forks_count": 6876,
      "mirror_url": null,
      "archived": false,
      "disabled": false,
      "open_issues_count": 1989,
      "license": {
        "key": "apache-2.0",
        "name": "Apache License 2.0",
        "spdx_id": "Apache-2.0",
        "url": "https://api.github.com/licenses/apache-2.0",
        "node_id": "MDc6TGljZW5zZTI="
      },
      "allow_forking": true,
      "is_template": false,
      "web_commit_signoff_required": false,
      "topics": [
        "mxnet"
      ],
      "visibility": "public",
      "forks": 6876,
      "open_issues": 1989,
      "watchers": 20203,
      "default_branch": "master"
    }
  },
  "_links": {
    "self": {
      "href": "https://api.github.com/repos/apache/mxnet/pulls/3781"
    },
    "html": {
      "href": "https://github.com/apache/mxnet/pull/3781"
    },
    "issue": {
      "href": "https://api.github.com/repos/apache/mxnet/issues/3781"
    },
    "comments": {
      "href": "https://api.github.com/repos/apache/mxnet/issues/3781/comments"
    },
    "review_comments": {
      "href": "https://api.github.com/repos/apache/mxnet/pulls/3781/comments"
    },
    "review_comment": {
      "href": "https://api.github.com/repos/apache/mxnet/pulls/comments{/number}"
    },
    "commits": {
      "href": "https://api.github.com/repos/apache/mxnet/pulls/3781/commits"
    },
    "statuses": {
      "href": "https://api.github.com/repos/apache/mxnet/statuses/ff541255e6e2d98c0b91ac8bcf6a9cae54da17e9"
    }
  },
  "author_association": "CONTRIBUTOR",
  "auto_merge": null,
  "active_lock_reason": null,
  "merged": true,
  "mergeable": null,
  "rebaseable": null,
  "mergeable_state": "unknown",
  "merged_by": {
    "login": "piiswrong",
    "id": 568948,
    "node_id": "MDQ6VXNlcjU2ODk0OA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/568948?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/piiswrong",
    "html_url": "https://github.com/piiswrong",
    "followers_url": "https://api.github.com/users/piiswrong/followers",
    "following_url": "https://api.github.com/users/piiswrong/following{/other_user}",
    "gists_url": "https://api.github.com/users/piiswrong/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/piiswrong/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/piiswrong/subscriptions",
    "organizations_url": "https://api.github.com/users/piiswrong/orgs",
    "repos_url": "https://api.github.com/users/piiswrong/repos",
    "events_url": "https://api.github.com/users/piiswrong/events{/privacy}",
    "received_events_url": "https://api.github.com/users/piiswrong/received_events",
    "type": "User",
    "site_admin": false
  },
  "comments": 14,
  "review_comments": 0,
  "maintainer_can_modify": false,
  "commits": 10,
  "additions": 133,
  "deletions": 38,
  "changed_files": 3
}